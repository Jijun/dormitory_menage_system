<!DOCTYPE html>

<html>

	<head>
		<meta charset="utf-8">
		<title>layuiAdmin 网站用户 iframe 框</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<script type="text/javascript" charset="utf8" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
		<link rel="stylesheet" href="../../../layuiadmin/layui/css/layui.css" media="all">
	</head>

	<body>

		<div class="layui-form layui-form-pane" lay-filter="layuiadmin-form-useradmin" id="layuiadmin-form-useradmin" style="padding: 20px 20px 0 75px;">
			<div class="layui-form-item">
				<label class="layui-form-label" style="color: #808080;">用户ID <a style="color: red;">*</a></label>
				<div class="layui-input-inline">
					<input type="text" name="userid" id="userid" placeholder="" autocomplete="off" class="layui-input" disabled="disabled">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label" style="color: #808080;">用户名 <a style="color: red;">*</a></label>
				<div class="layui-input-inline">
					<input type="text" name="username" id="username" placeholder="请输入用户名" autocomplete="off" class="layui-input" disabled="disabled">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">绑定邮箱</label>
				<div class="layui-input-inline">
					<input type="text" name="useremail" id="useremail" lay-verify="email" placeholder="请输入邮箱" autocomplete="off" class="layui-input">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">真实姓名</label>
				<div class="layui-input-inline" style="width: 70px;">
					<input type="text" name="userfirstname" id="userfirstname" lay-verify="firstname" placeholder="姓" autocomplete="off" class="layui-input">
				</div>
				<div class="layui-input-inline" style="width: 110px;">
					<input type="text" name="userlastname" id="userlastname" lay-verify="lastname" placeholder="名" autocomplete="off" class="layui-input">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">出生日期</label>
				<div class="layui-input-inline">
					<input type="text" name="userbirthday" id="userbirthday" lay-verify="data" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">手机号码</label>
				<div class="layui-input-inline">
					<input type="text" name="usermobile" id="usermobile" lay-verify="phone" placeholder="请输入号码" autocomplete="off" class="layui-input">
				</div>
			</div>
			<!--<div class="layui-form-item">
				<label class="layui-form-label">头像</label>
				<div class="layui-input-inline">
					<input type="text" name="avatar" lay-verify="required" placeholder="请上传图片" autocomplete="off" class="layui-input">
				</div>
				<button style="float: left;" type="button" class="layui-btn" id="layuiadmin-upload-useradmin">上传图片</button>
			</div>-->
			<div class="layui-form-item" lay-filter="sex" pane="" style="width: 297px;">
				<label class="layui-form-label">选择性别 <a style="color: red;">*</a></label>
				<div class="layui-input-block">
					<input type="radio" name="usergender" value="male" title="男">
					<input type="radio" name="usergender" value="female" title="女">
					<input type="radio" name="usergender" value="unknown" title="未知">
				</div>
			</div>
			<div class="layui-form-item layui-hide">
				<input type="button" lay-submit lay-filter="LAY-user-front-submit" id="LAY-user-front-submit" value="确认">
			</div>
		</div>

		<script src="../../../layuiadmin/layui/layui.js"></script>
		<script>
			layui.use(['form', 'layedit', 'laydate'], function() {
				var form = layui.form,
					layer = layui.layer,
					laydate = layui.laydate;

				//日期
				laydate.render({
					elem: '#userbirthday'
				});

				//自定义验证规则
				form.verify({
					email: [/(^$)|^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/, '邮箱格式不正确'],
					firstname: [/(^$)|^[\u4E00-\u9FA5]{1,2}$/, '姓必须为1到2个中文'],
					lastname: [/(^$)|^[\u4E00-\u9FA5]{1,2}$/, '名必须为1到2个中文'],
					date: [/(^$)|^(\d{4})[-\/](\d{1}|0\d{1}|1[0-2])([-\/](\d{1}|0\d{1}|[1-2][0-9]|3[0-1]))*$/, '日期格式不正确'],
					phone: [/(^$)|^1\d{10}$/, '请输入正确的手机号'],
					pass: [/^[\S]{6,16}$/, '密码必须6到16位，且不能出现空格']
				});

				// 获取url的参数并赋值
				function GetQueryString(name) {
					var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
					var r = window.location.search.substr(1).match(reg);
					if(r != null) return decodeURI(r[2]);
					return null;
				}
				var id = GetQueryString("id");
				if(id != null) {
					$.ajax({
						url: "http://127.0.0.1:8000/users/" + id + "/",
						type: "get",
						dataType: "json",
						success: function(data) {
							if(data.userinfo == null) {
								form.val("layuiadmin-form-useradmin", { //formTest 即 class="layui-form" 所在元素属性 lay-filter="" 对应的值
									"userid": id,
									"username": data.username,
									"useremail": data.email,
									"userfirstname": data.first_name,
									"userlastname": data.last_name,
									"usergender": 'unknown'
								});
							} else {
								form.val("layuiadmin-form-useradmin", { //formTest 即 class="layui-form" 所在元素属性 lay-filter="" 对应的值
									"userid": id,
									"username": data.username,
									"useremail": data.email,
									"userfirstname": data.first_name,
									"userlastname": data.last_name,
									"userbirthday": data.userinfo.birthday,
									"usermobile": data.userinfo.mobile,
									"usergender": data.userinfo.gender
								});
							}
						},
						error: function(jqXHR) {
							layer.msg('数据加载错误，请联系管理员处理', {
								icon: 2,
								anim: 6
							});
						}
					});
				}
			});

			/*
			//监听指定开关
			form.on('switch(switchTest)', function(data) {
				layer.msg('开关checked：' + (this.checked ? 'true' : 'false'), {
					offset: '6px'
				});
				layer.tips('温馨提示：请注意开关状态的文字可以随意定义，而不仅仅是ON|OFF', data.othis)
			});

			//监听提交
			form.on('submit(demo1)', function(data) {
				layer.alert(JSON.stringify(data.field), {
					title: '最终的提交信息'
				})
				return false;
			});

			//表单取值
			layui.$('#LAY-component-form-getval').on('click', function() {
				var data = form.val('example');
				alert(JSON.stringify(data));
			});
			*/

			/*
			layui.config({
				base: '../../../layuiadmin/' //静态资源所在路径
			}).extend({
				index: 'lib/index' //主入口模块
			}).use(['index', 'form', 'upload'], function() {
				var $ = layui.$,
					form = layui.form,
					upload = layui.upload;

				upload.render({
					elem: '#layuiadmin-upload-useradmin',
					url: layui.setter.base + 'json/upload/demo.js',
					accept: 'images',
					method: 'get',
					acceptMime: 'image/*',
					done: function(res) {
						$(this.item).prev("div").children("input").val(res.data.src)
					}
				});
			})
			*/
		</script>
	</body>
	<script>
	</script>

</html>